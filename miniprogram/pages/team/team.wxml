<view class="container">
  <!-- State: Has Team -->
  <block wx:if="{{team}}">
    <!-- Team Header -->
    <view class="team-header">
      <view class="team-name">{{team.name}}</view>
      <view class="team-code" bindtap="copyCode" data-code="{{team.inviteCode}}">
        <text class="code-label">é‚€è¯·ç </text>
        <text class="code-val">{{team.inviteCode}}</text>
        <text class="copy-icon">ğŸ“„</text>
      </view>
      <button class="btn share-btn" open-type="share">é‚€è¯·å¥½å‹åŠ å…¥</button>
    </view>

    <!-- Member List -->
    <view class="section-title">å°é˜Ÿæˆå‘˜ ({{team.members.length}}äºº)</view>
    <view class="member-list">
      <block wx:for="{{team.members}}" wx:key="userId">
        <view class="member-item">
          <view class="member-left">
            <image class="avatar" src="{{item.avatarUrl || 'https://mmbiz.qpic.cn/mmbiz/icTdbqWNOwNRna42FI242Lcia07jQodd2FJGIYQfG0LAJGFxM4FbnQP6yfMxBgJ0F3YRqJCJ1aPAK2dQagdusBZg/0'}}" mode="aspectFill"></image>
            <view class="member-info">
              <view class="member-name">{{item.nickname || 'ç¥ç§˜é˜Ÿå‹'}}</view>
              <view class="checkin-status {{item.checkedInToday ? 'active' : ''}}">
                {{item.checkedInToday ? 'âœ… ä»Šæ—¥å·²æ‰“å¡' : 'â­•ï¸ ä»Šæ—¥æœªæ‰“å¡'}}
              </view>
            </view>
          </view>
          <view class="member-right">
            <view class="delta-val {{item.weekDeltaKg > 0 ? 'text-success' : (item.weekDeltaKg < 0 ? 'text-danger' : 'text-muted')}}">
              {{item.weekDeltaText}}
            </view>
            <view class="text-xs">æœ¬å‘¨å˜åŒ–</view>
          </view>
        </view>
      </block>
    </view>

    <view class="footer-actions">
      <button class="btn btn-danger-outline" bindtap="leave">é€€å‡ºå°é˜Ÿ</button>
    </view>
  </block>

  <!-- State: No Team -->
  <block wx:else>
    <view class="no-team-header">
      <view class="text-xl">åŠ å…¥å°é˜Ÿ</view>
      <view class="text-secondary">ä¸å¥½å‹ä¸€èµ·åšæŒï¼Œäº’ç›¸ç›‘ç£</view>
    </view>

    <!-- Join Team -->
    <view class="form-card">
      <view class="card-title">æˆ‘æœ‰é‚€è¯·ç </view>
      <view class="input-group">
        <input class="input" placeholder="è¾“å…¥é‚€è¯·ç " value="{{inviteCode}}" bindinput="onInputInviteCode" />
        <button class="btn btn-sm" loading="{{joining}}" bindtap="join">åŠ å…¥</button>
      </view>
    </view>

    <!-- Create Team -->
    <view class="form-card">
      <view class="card-title">åˆ›å»ºæ–°å°é˜Ÿ</view>
      <view class="input-group">
        <input class="input" placeholder="ç»™å°é˜Ÿèµ·ä¸ªåå­—" value="{{createName}}" bindinput="onInputCreateName" />
        <button class="btn btn-sm" loading="{{creating}}" bindtap="create">åˆ›å»º</button>
      </view>
    </view>
  </block>
</view>
